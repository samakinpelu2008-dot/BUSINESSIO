<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Login â€¢ Businessio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#f4f6fb;display:flex;justify-content:center;align-items:center;height:100vh}
.container{background:#fff;padding:40px;border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.1);width:100%;max-width:400px}
h2{text-align:center;margin-bottom:25px;color:#1f4cff}
input{width:100%;padding:12px;margin-bottom:15px;border-radius:8px;border:1px solid #ccc;font-size:14px}
button{width:100%;padding:14px;border:none;border-radius:10px;background:#1f4cff;color:#fff;font-weight:700;cursor:pointer}
button:hover{background:#1636d0}
p{font-size:13px;text-align:center;color:#555}
</style>
</head>

<body>

<div class="container">
  <h2>Login</h2>
  <input id="email" placeholder="Email" type="email">
  <input id="password" placeholder="Password" type="password">
  <button onclick="login()">Login</button>
  <p>Don't have an account? <a href="signup.html">Sign Up</a></p>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyDeFlOeRoiNjqH9LAclnqnehXNY6scPqzE",
  authDomain:"businessio-37c69.firebaseapp.com",
  projectId:"businessio-37c69"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

async function login(){
  const emailVal=document.getElementById("email").value.trim();
  const passwordVal=document.getElementById("password").value.trim();

  if(!emailVal || !passwordVal){
    alert("Please fill all fields.");
    return;
  }

  try{
    const userCred=await signInWithEmailAndPassword(auth,emailVal,passwordVal);
    const user=userCred.user;

    if(!user.emailVerified){
      alert("Please verify your email before logging in.");
      return;
    }

    // Fetch user info
    const userDoc=await getDoc(doc(db,"users",user.uid));
    if(!userDoc.exists()){
      alert("User data not found.");
      return;
    }

    const userData=userDoc.data();

    // Optional: Store user info locally
    localStorage.setItem("userData",JSON.stringify(userData));

    // Redirect to user dashboard
    window.location.href="dashboard.html";

    // Optional: Trigger login message email (requires Cloud Function)
    // Example: call your Firebase Cloud Function here

  }catch(error){
    alert("Login failed: "+error.message);
  }
}
</script>

</body>
</html>
