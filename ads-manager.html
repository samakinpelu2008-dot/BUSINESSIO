<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ads Manager • Businessio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#f4f6fb}
header{
  background:#1f4cff;color:#fff;padding:15px 25px;
  display:flex;justify-content:space-between;align-items:center
}
.container{
  max-width:1100px;margin:30px auto;padding:0 15px
}
.card{
  background:#fff;padding:20px;border-radius:16px;
  box-shadow:0 8px 25px rgba(0,0,0,.06);
  margin-bottom:20px
}
.grid{
  display:grid;grid-template-columns:1fr 1fr;gap:15px
}
input,select{
  padding:12px;border-radius:8px;border:1px solid #ccc;width:100%
}
button{
  padding:12px 16px;border:none;border-radius:10px;
  font-weight:700;cursor:pointer
}
.primary{background:#1f4cff;color:#fff}
.danger{background:#fee2e2;color:#991b1b}
.small{font-size:13px;color:#555}
.stat{font-weight:700}
</style>
</head>

<body>

<header>
  <h2>Ads Manager</h2>
  <button onclick="location.href='admin-dashboard.html'">← Admin</button>
</header>

<div class="container">

  <!-- ADD AD -->
  <div class="card">
    <h3>Create New Ad</h3>
    <div class="grid">
      <input id="title" placeholder="Ad title">
      <select id="type">
        <option value="image">Image</option>
        <option value="video">Video</option>
      </select>
      <input id="media" placeholder="Image or video URL">
      <input id="link" placeholder="Target link">
    </div>
    <br>
    <button class="primary" onclick="createAd()">Create Ad</button>
  </div>

  <!-- ADS LIST -->
  <div id="ads"></div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
  getFirestore, collection, addDoc, getDocs,
  updateDoc, deleteDoc, doc, serverTimestamp
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyDeFlOeRoiNjqH9LAclnqnehXNY6scPqzE",
  authDomain:"businessio-37c69.firebaseapp.com",
  projectId:"businessio-37c69"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

async function loadAds(){
  ads.innerHTML="";
  const snap=await getDocs(collection(db,"ads"));

  snap.forEach(d=>{
    const a=d.data();
    ads.innerHTML+=`
      <div class="card">
        <b>${a.title}</b> (${a.type})<br>
        <span class="small">${a.mediaUrl}</span><br><br>

        <span class="stat">Views:</span> ${a.views || 0} |
        <span class="stat">Clicks:</span> ${a.clicks || 0}
        <br><br>

        <button class="danger" onclick="removeAd('${d.id}')">Delete</button>
      </div>
    `;
  });
}

window.createAd=async()=>{
  if(!title.value||!media.value||!link.value){
    alert("Fill all fields");
    return;
  }

  await addDoc(collection(db,"ads"),{
    title:title.value,
    type:type.value,
    mediaUrl:media.value,
    targetUrl:link.value,
    views:0,
    clicks:0,
    created:serverTimestamp(),
    active:true
  });

  title.value=media.value=link.value="";
  loadAds();
};

window.removeAd=id=>{
  if(confirm("Delete this ad?")){
    deleteDoc(doc(db,"ads",id));
    loadAds();
  }
};

loadAds();
</script>

</body>
</html>
