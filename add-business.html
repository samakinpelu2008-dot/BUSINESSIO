<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add Business • Businessio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#f5f7fb}
header{
  background:#1f4cff;color:#fff;padding:15px 25px;
  display:flex;justify-content:space-between;align-items:center
}
.container{
  max-width:900px;margin:30px auto;background:#fff;
  padding:25px;border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.06)
}
.section{margin-bottom:25px}
.section h3{margin-bottom:10px;color:#1f4cff}
input,select,textarea{
  width:100%;padding:12px;margin-top:8px;
  border-radius:8px;border:1px solid #ccc
}
textarea{resize:vertical}
.grid{
  display:grid;grid-template-columns:1fr 1fr;gap:15px
}
button{
  padding:14px;border:none;border-radius:10px;
  font-weight:700;cursor:pointer
}
.primary{background:#1f4cff;color:#fff}
.secondary{background:#eef2ff;color:#1f4cff}
.actions{display:flex;gap:15px;flex-wrap:wrap}
small{color:#666}
</style>
</head>

<body>

<header>
  <h2>Add Business</h2>
  <button class="secondary" onclick="back()">← Dashboard</button>
</header>

<div class="container">

  <!-- BASIC INFO -->
  <div class="section">
    <h3>Basic Information</h3>
    <input id="name" placeholder="Business name">
    <textarea id="desc" placeholder="Describe what this business / offer is about"></textarea>
  </div>

  <!-- CATEGORY -->
  <div class="section">
    <h3>Category</h3>
    <select id="category">
      <option>Technology</option>
      <option>Jobs</option>
      <option>Services</option>
      <option>Education</option>
      <option>Sales</option>
      <option>Others</option>
    </select>
  </div>

  <!-- LOCATION & LIMITS -->
  <div class="section">
    <h3>Requirements & Limits</h3>
    <div class="grid">
      <input id="country" placeholder="Country">
      <input id="state" placeholder="State">
      <input id="location" placeholder="City / Area">
      <input id="age" placeholder="Minimum age">
      <input id="max" type="number" placeholder="Max applicants">
      <input id="time" placeholder="Available time (e.g Full time)">
    </div>
  </div>

  <!-- MEDIA -->
  <div class="section">
    <h3>Media</h3>
    <input type="file" id="image">
    <small>You can update or remove later</small>
  </div>

  <!-- ACTIONS -->
  <div class="actions">
    <button class="primary" onclick="publish('pending')">Publish</button>
    <button class="secondary" onclick="publish('draft')">Save as Draft</button>
  </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyDeFlOeRoiNjqH9LAclnqnehXNY6scPqzE",
  authDomain:"businessio-37c69.firebaseapp.com",
  projectId:"businessio-37c69"
};

const app=initializeApp(firebaseConfig);
const auth=getAuth(app);
const db=getFirestore(app);

let user=null;

onAuthStateChanged(auth,u=>{
  if(!u) location.href="login.html";
  user=u;
});

window.publish=async(status)=>{
  if(!name.value||!desc.value){
    alert("Fill required fields");
    return;
  }

  await addDoc(collection(db,"businesses"),{
    ownerId:user.uid,
    name:name.value,
    desc:desc.value,
    category:category.value,
    country:country.value,
    state:state.value,
    location:location.value,
    age:age.value,
    maxApplicants:max.value,
    time:time.value,
    status:status,
    sales:0,
    complaints:0,
    created:serverTimestamp()
  });

  alert(status==="draft"?"Saved as draft":"Submitted for approval");
  location.href="dashboard.html";
};

window.back=()=>location.href="dashboard.html";
</script>

</body>
</html>
