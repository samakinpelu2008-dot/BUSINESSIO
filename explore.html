<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Explore Businesses â€¢ Businessio</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#f4f6fb}
header{
  background:#1f4cff;color:#fff;padding:15px 25px;
  display:flex;justify-content:space-between;align-items:center
}
.filters{
  display:flex;gap:10px;flex-wrap:wrap;
  padding:15px;background:#fff
}
select{
  padding:10px;border-radius:8px;border:1px solid #ccc
}
.container{
  max-width:1200px;margin:20px auto;
  display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:20px;padding:0 15px
}
.card{
  background:#fff;padding:18px;border-radius:16px;
  box-shadow:0 8px 25px rgba(0,0,0,.05);
  cursor:pointer;transition:.2s
}
.card:hover{transform:translateY(-4px)}
.card h3{margin:0;color:#1f4cff}
.card p{font-size:14px;color:#555}
.badge{
  display:inline-block;background:#eef2ff;color:#1f4cff;
  padding:4px 8px;border-radius:6px;font-size:12px
}
</style>
</head>

<body>

<header>
  <h2>Explore</h2>
  <button onclick="location.href='dashboard.html'">Dashboard</button>
</header>

<div class="filters">
  <select id="category" onchange="load()">
    <option value="">All Categories</option>
    <option>Technology</option>
    <option>Jobs</option>
    <option>Services</option>
    <option>Education</option>
    <option>Sales</option>
  </select>

  <select id="country" onchange="load()">
    <option value="">All Countries</option>
    <option>Nigeria</option>
    <option>Ghana</option>
    <option>UK</option>
  </select>
</div>

<div class="container" id="list"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig={
  apiKey:"AIzaSyDeFlOeRoiNjqH9LAclnqnehXNY6scPqzE",
  authDomain:"businessio-37c69.firebaseapp.com",
  projectId:"businessio-37c69"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

window.load=async()=>{
  list.innerHTML="Loading...";
  let q=collection(db,"businesses");

  let conditions=[where("status","==","pending")];

  if(category.value) conditions.push(where("category","==",category.value));
  if(country.value) conditions.push(where("country","==",country.value));

  const snap=await getDocs(query(q,...conditions));
  list.innerHTML="";

  snap.forEach(doc=>{
    const d=doc.data();
    list.innerHTML+=`
      <div class="card" onclick="openBiz('${doc.id}')">
        <span class="badge">${d.category}</span>
        <h3>${d.name}</h3>
        <p>${d.desc.slice(0,80)}...</p>
        <small>${d.country || ''} ${d.state || ''}</small>
      </div>
    `;
  });

  if(!snap.size) list.innerHTML="<p>No businesses found</p>";
};

window.openBiz=id=>{
  location.href=`business.html?id=${id}`;
};

load();
</script>

</body>
</html>
